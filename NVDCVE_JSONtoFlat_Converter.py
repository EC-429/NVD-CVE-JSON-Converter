# Python program to read the NVD CVE downloadable JSON file and parse out only key metrics,
# including: CVE ID, Description (i.e Name), Base Score, Severity, and Impact Score

import json

# Opening JSON file
x = open('nvdcve-1.1-modified.json')

# Creating output file
y = open('nvdcve-converted.txt', 'w')

# returns JSON object as
# a dictionary
data = json.load(x)

# Iterating through the json
# list
for i in data['CVE_Items']:
    a = i['cve']['CVE_data_meta']['ID']
    b = i['cve']['description']['description_data'][0]['value']
    if 'baseMetricV2' in i['impact']:
        c = i['impact']['baseMetricV2']['cvssV2']['baseScore']
        d = i['impact']['baseMetricV2']['severity']
        e = i['impact']['baseMetricV2']['impactScore']
        print(a, "|", b, "|", c, "|", d, "|", e, file=y)

# Closing file
x.close()
